{% comment %}
  Produkt-Grids für Collection-Seite
  - Nutzt das aktuelle Collection-Objekt
  - Saubere Cards, responsive Grid
{% endcomment %}

<section class="hw-collection">
  {% if collection.title %}
    <h1 class="hw-collection__title">
      {{ collection.title }}
    </h1>
  {% endif %}

  {% if collection.description != blank %}
    <div class="hw-collection__desc">
      {{ collection.description }}
    </div>
  {% endif %}

  {% if collection.products_count == 0 %}
    <p class="hw-collection__empty">
      Aktuell sind hier keine Produkte verfügbar.
    </p>
  {% else %}
    <div class="hw-grid">
      {% for product in collection.products %}
        {%- assign hw_color = '' -%}
{%- assign hw_brand = '' -%}
{%- assign hw_rare  = '' -%}
{%- for t in product.tags -%}
  {%- if t contains 'Farbe:' -%}
    {%- assign hw_color = t | remove: 'Farbe:' | strip -%}
  {%- endif -%}
  {%- if t contains 'Marke:' -%}
    {%- assign hw_brand = t | remove: 'Marke:' | strip -%}
  {%- endif -%}
  {%- if t contains 'Seltenheit:' -%}
    {%- assign hw_rare = t | remove: 'Seltenheit:' | strip -%}
  {%- endif -%}
{%- endfor -%}
{%- assign hw_price_cents = product.price | divided_by: 1 -%}

<article
  class="product-card"
  data-color="{{ hw_color }}"
  data-brand="{{ hw_brand }}"
  data-rare="{{ hw_rare }}"
  data-price="{{ hw_price_cents }}"
>
          <a href="{{ product.url }}" class="hw-card__link">
            <div class="hw-card__image-wrap">
              {% if product.featured_image %}
                <img
                  src="{{ product.featured_image | img_url: '540x540' }}"
                  alt="{{ product.featured_image.alt | escape }}"
                  loading="lazy"
                  class="hw-card__image"
                >
              {% endif %}

              {%- if product.compare_at_price_max > product.price -%}
                <div class="hw-card__badge hw-card__badge--sale">
                  Sale
                </div>
              {%- endif -%}
            </div>

            <div class="hw-card__body">
              <h2 class="hw-card__title">
                {{ product.title }}
              </h2>

              <div class="hw-card__prices">
                {% if product.compare_at_price_max > product.price %}
                  <span class="hw-card__price--old">
                    {{ product.compare_at_price_max | money }}
                  </span>
                {% endif %}
                <span class="hw-card__price">
                  {{ product.price | money }}
                </span>
              </div>
            </div>
          </a>

          <form method="post" action="/cart/add" class="hw-card__form" enctype="multipart/form-data">
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
            <button type="submit" class="hw-card__btn">
              In den Warenkorb
            </button>
          </form>
        </article>
      {% endfor %}
    </div>
  {% endif %}
</section>

{% schema %}
{
  "name": "Produktgrid",
  "settings": []
}
{% endschema %}
