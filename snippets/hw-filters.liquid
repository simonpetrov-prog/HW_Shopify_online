<!-- HW FILTER SECTION -->
<div class="hw-filter-box">
  <!-- Tabs -->
  <div class="hw-filter-tabs">
    <button class="hw-tab active" data-filter="price">Preis</button>
    <button class="hw-tab" data-filter="color">Farbe</button>
    <button class="hw-tab" data-filter="brand">Marke</button>
    <button class="hw-tab" data-filter="rarity">Seltenheit</button>
  </div>

  <!-- Panels -->
  <div class="hw-filter-panels">
    <!-- Preis -->
    <div class="hw-panel" data-panel="price">
      <div class="hw-price-row">
        <label>von</label>
        <input type="number" name="min_price" step="0.01" min="0" placeholder="2,99">
      </div>
      <div class="hw-price-row">
        <label>bis</label>
        <input type="number" name="max_price" step="0.01" min="0" placeholder="9,99">
      </div>
    </div>

    <!-- Farbe -->
    <div class="hw-panel hw-scroll" data-panel="color" hidden>
      <label class="hw-chip"><input type="checkbox" name="color" value="rot"><span class="dot"></span><span>Rot</span></label>
      <label class="hw-chip"><input type="checkbox" name="color" value="blau"><span class="dot"></span><span>Blau</span></label>
      <label class="hw-chip"><input type="checkbox" name="color" value="weiß"><span class="dot"></span><span>Weiß</span></label>
      <label class="hw-chip"><input type="checkbox" name="color" value="schwarz"><span class="dot"></span><span>Schwarz</span></label>
      <label class="hw-chip"><input type="checkbox" name="color" value="orange"><span class="dot"></span><span>Orange</span></label>
      <label class="hw-chip"><input type="checkbox" name="color" value="grau"><span class="dot"></span><span>Grau</span></label>
      <label class="hw-chip"><input type="checkbox" name="color" value="grün"><span class="dot"></span><span>Grün</span></label>
      <label class="hw-chip"><input type="checkbox" name="color" value="gelb"><span class="dot"></span><span>Gelb</span></label>
    </div>

    <!-- Marke -->
    <div class="hw-panel hw-scroll" data-panel="brand" hidden>
      <label class="hw-chip"><input type="checkbox" name="brand" value="porsche"><span>Porsche</span></label>
      <label class="hw-chip"><input type="checkbox" name="brand" value="ferrari"><span>Ferrari</span></label>
      <label class="hw-chip"><input type="checkbox" name="brand" value="bmw"><span>BMW</span></label>
      <label class="hw-chip"><input type="checkbox" name="brand" value="mercedes"><span>Mercedes</span></label>
      <label class="hw-chip"><input type="checkbox" name="brand" value="toyota"><span>Toyota</span></label>
      <label class="hw-chip"><input type="checkbox" name="brand" value="lamborghini"><span>Lamborghini</span></label>
      <label class="hw-chip"><input type="checkbox" name="brand" value="koenigsegg"><span>Koenigsegg</span></label>
    </div>

    <!-- Seltenheit -->
    <div class="hw-panel hw-scroll" data-panel="rarity" hidden>
      <label class="hw-chip"><input type="checkbox" name="rarity" value="th"><span>Treasure Hunt</span></label>
      <label class="hw-chip"><input type="checkbox" name="rarity" value="sth"><span>Super Treasure Hunt</span></label>
    </div>
  </div>

  <!-- Aktionen -->
  <div class="hw-filter-actions">
    <button class="btn" data-filter-apply>Filter anwenden</button>
    <button class="btn-outline" data-filter-reset>Zurücksetzen</button>
  </div>
</div>

<style>
/* ---- Container ---- */
.hw-filter-box{
  border:3px solid #0046BE;
  border-radius:16px;
  background:#fff;
  padding:14px 16px 12px;
  margin-bottom:18px;
  box-shadow:0 4px 16px rgba(0,0,0,.05);
}

/* ---- Tabs ---- */
.hw-filter-tabs{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-bottom:12px;
}
.hw-tab{
  background:#f5f5f5;
  border:2px solid #eee;
  border-radius:10px;
  padding:7px 14px;
  font-weight:800;
  cursor:pointer;
  transition:all .15s;
}
.hw-tab:hover{
  border-color:#FF6B00;
  color:#FF6B00;
}
.hw-tab.active{
  background:#0046BE;
  color:#fff;
  border-color:#0046BE;
  box-shadow:0 2px 6px rgba(0,70,190,.25);
}

/* ---- Panels ---- */
.hw-panel{ display:none; margin-bottom:12px; }
.hw-panel:not([hidden]){
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap:10px;
  align-items:center;
}

/* Preis-Panel */
.hw-price-row{
  display:flex;
  flex-direction:column;
  gap:4px;
}
.hw-price-row input{
  width:110px;
  max-width:110px;
  border:1px solid #d1d5db;
  border-radius:10px;
  padding:6px 8px;
}

/* ---- Scrollbare Panels ---- */
.hw-scroll{
  max-height:160px;
  overflow:auto;
  padding-right:6px;
}
.hw-scroll::-webkit-scrollbar{
  width:8px;
  height:8px;
}
.hw-scroll::-webkit-scrollbar-thumb{
  background:rgba(0,0,0,.2);
  border-radius:6px;
}
.hw-scroll::-webkit-scrollbar-track{
  background:transparent;
}

/* ---- Chips ---- */
.hw-chip{
  display:inline-flex;
  align-items:center;
  gap:8px;
  background:#F2F2F2;
  border:1px solid #E0E0E0;
  color:#333;
  border-radius:999px;
  padding:6px 10px;
  font-weight:700;
  font-size:14px;
  cursor:pointer;
  transition:all .15s;
}
.hw-chip input{ display:none; }
.hw-chip .dot{
  width:14px;
  height:14px;
  border-radius:50%;
  background:#ddd;
}
.hw-chip.is-checked{
  background:#0046BE;
  border-color:#0046BE;
  color:#fff;
  box-shadow:0 2px 6px rgba(0,70,190,.22);
}
.hw-chip.is-checked .dot{ background:#fff; }

/* ---- Aktionen ---- */
.hw-filter-actions{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-top:8px;
}
.btn{
  background:#FF6B00;
  color:#fff;
  border:0;
  border-radius:10px;
  padding:8px 16px;
  font-weight:800;
  cursor:pointer;
}
.btn-outline{
  background:#fff;
  color:#0046BE;
  border:2px solid #0046BE;
  border-radius:10px;
  padding:8px 16px;
  font-weight:800;
  cursor:pointer;
}
.btn:hover{ filter:brightness(.95); }
.btn-outline:hover{ background:#0046BE; color:#fff; }

/* ---- Mobile ---- */
@media (max-width:700px){
  .hw-panel:not([hidden]){
    display:flex;
    flex-wrap:wrap;
    align-items:flex-start;
  }
  .hw-scroll{
    max-height:200px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  // Tabs
  document.querySelectorAll('.hw-tab').forEach(tab=>{
    tab.addEventListener('click',()=>{
      document.querySelectorAll('.hw-tab').forEach(t=>t.classList.remove('active'));
      document.querySelectorAll('.hw-panel').forEach(p=>p.hidden=true);
      tab.classList.add('active');
      const panel=document.querySelector(`.hw-panel[data-panel="${tab.dataset.filter}"]`);
      if(panel) panel.hidden=false;
    });
  });

  // Chip-Optik koppeln
  const syncChip = (inp)=>{
    const chip = inp.closest('.hw-chip');
    if (!chip) return;
    chip.classList.toggle('is-checked', inp.checked);
  };
  document.querySelectorAll('.hw-chip > input').forEach(inp=>{
    syncChip(inp);
    inp.addEventListener('change', ()=>syncChip(inp));
  });

  // Reset Button
  const resetBtn = document.querySelector('[data-filter-reset]');
  if (resetBtn) resetBtn.addEventListener('click', ()=>{
    document.querySelectorAll('.hw-panel input[type="checkbox"]').forEach(i=>i.checked=false);
    document.querySelectorAll('.hw-panel input[type="number"]').forEach(i=>i.value='');
    document.querySelectorAll('.hw-chip').forEach(c=>c.classList.remove('is-checked'));
  });
});

<script>
document.addEventListener("DOMContentLoaded", () => {
  const applyBtn = document.querySelector(".hw-apply");
  const resetBtn = document.querySelector(".hw-reset");

  if (!applyBtn) return;

  // Sammle alle Filter-Optionen
  function getSelectedFilters() {
    const params = new URLSearchParams();

    document.querySelectorAll(".hw-filter-group").forEach(group => {
      const key = group.dataset.filter;
      const checked = [...group.querySelectorAll("input:checked")].map(i => i.value);

      if (checked.length > 0) {
        params.append(key, checked.join(","));
      }
    });

    // Preis extra sammeln
    const min = document.getElementById("price-min")?.value;
    const max = document.getElementById("price-max")?.value;

    if (min) params.append("price_min", min);
    if (max) params.append("price_max", max);

    return params;
  }

  // Anwenden → Seite neu laden
  applyBtn.addEventListener("click", () => {
    const params = getSelectedFilters();
    const base = window.location.pathname;

    window.location = base + (params.toString() ? "?" + params.toString() : "");
  });

  // Zurücksetzen
  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      const base = window.location.pathname;
      window.location = base; // komplette URL ohne Filter
    });
  }

  // Buttons Blau / Grau toggeln
  document.querySelectorAll(".hw-chip input").forEach(input => {
    input.addEventListener("change", () => {
      input.closest("label").classList.toggle("active", input.checked);
    });
  });
});
</script>

</script>
